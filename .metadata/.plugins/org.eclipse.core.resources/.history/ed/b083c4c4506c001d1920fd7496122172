package Test;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.WebDriver;

import Pages.Page1;
import Pages.Page2;
import Pages.Page3;
import Pages.Page4;

public class MasterTest {

	 WebDriver driverMaster;Page1 page1;Page2 page2;Page3 page3; Page4 page4;
	//File src;FileInputStream fis;XSSFWorkbook xsf;XSSFSheet sheet;
	///String Registration;
//	String BusinessPurpouse;String CommunityPurpouse;String TypeOfBusiness;String KM;String Male;String Name;String Surname;double Day;
//	double Month;double Year;String email;double Phone;String Employment;String Occupation;String Adress;String TypeofHouseHold;
//	String Licence;String EssentialDriving;String LicenceTime;String PenaltyPoints;double HowManyPenalty;String Reason;String RecentInsurance;
//	String NCD;String Discount;
	
	
	
	public MasterTest(WebDriver driver) throws IOException {
		this.driverMaster=driver;
		page1= new Page1(driverMaster);
		page2= new Page2(driverMaster);
		page3= new Page3(driverMaster);
		page4 = new Page4(driverMaster);
		
		
		//src = new File("C:/Users/Domin/eclipse-workspace/AxaIreland/src/test/java/Test/Data.xlsx");
		//fis= new FileInputStream(src);
	  //  xsf= new XSSFWorkbook(fis);
		//sheet = xsf.getSheetAt(0);
	}

	public MasterTest PageOneLouncher() throws InterruptedException, IOException { 
		
		
		
	page1.CookiesHandler().
		  EnterRegistrationNumber(MasterData.Registration).
	      WillthisCarbeUsedforBusinessPurpouseorCommunity(MasterData.BusinessPurpouse,MasterData.CommunityPurpouse);

				if (page1.CheckifTextIsDisyplayed("What type of business use cover do you require?")) {
					page1.TypeOfBusinessCover(MasterData.TypeOfBusiness);
					}
	 page1.HowManyKilometersPerYear(MasterData.KM).
	       EnterYouPersonalData(MasterData.Male,MasterData.Name, MasterData.Surname).
	       EnterYouDataOfBirth(MasterData.Day, MasterData.Month,MasterData.Year).
	       EnterEmailandPhoneNumber(MasterData.email,MasterData.Phone).
	       EmploymentStatus(MasterData.Employment);
	 
		 		if(page1.CheckifTextIsDisyplayed("What is your occupation?")) {
		 		   page1.EnterOccupation(MasterData.Occupation);
		 		  }
		 		if(page1.CheckifTextIsDisyplayed("Please enter your address or Eircode")) {
		 		   page1.EnterAdress(MasterData.Adress);
		 		  }
	 
	page1.TypeOfHouseHold(MasterData.TypeofHouseHold).
		  CurrentLicenceType(MasterData.Licence);
	       
				 if(page1.CheckifTextIsDisyplayed("Have you completed the Essential Driver Training?")) {
					 page1.EssentialDrivingTrainin(MasterData.EssentialDriving);
				 }
	page1.HowLongLicence(MasterData.LicenceTime).
	       PenaltyPointQuestion("No");
	 
				 if(page1.CheckifTextIsDisyplayed(("How many penalty points do you have?"))){
					  page1.HowManyPenaltyPointandReason(MasterData.HowManyPenalty,MasterData.Reason);
				  }
				  if(page1.CheckifTextIsDisyplayed(("What was your most recent insurance?"))) {
					   page1.RecentInsuranceType(MasterData.RecentInsurance);
				  } 	
				 if(page1.CheckifTextIsDisyplayed("Number of years No Claims Discount earned in Ireland and/or the UK")){
					  page1.NumberOfNCD(MasterData.NCD);
				 }
	 page1.PolicyDiscount(MasterData.Discount).
	      DownSiteConfirmationandConfirmation();
	 return this;
  }	
	
	
	
	
	
	
//    public MasterTest DataRowLoader(int row) throws Exception {			 
//    	 
//	 
//   	      Registration= sheet.getRow(row).getCell(0).getStringCellValue();
//	      BusinessPurpouse= sheet.getRow(row).getCell(1).getStringCellValue();
//		  CommunityPurpouse = sheet.getRow(row).getCell(2).getStringCellValue();
//		  TypeOfBusiness= sheet.getRow(row).getCell(3).getStringCellValue();
//		  KM= sheet.getRow(row).getCell(4).getStringCellValue();
//		  Male= sheet.getRow(row).getCell(5).getStringCellValue();
//		  Name= sheet.getRow(row).getCell(6).getStringCellValue();
//		  Surname= sheet.getRow(row).getCell(7).getStringCellValue();
//		  Day= sheet.getRow(row).getCell(8).getNumericCellValue();
//		  Month= sheet.getRow(row).getCell(9).getNumericCellValue();
//		  Year = sheet.getRow(row).getCell(10).getNumericCellValue();
//		  email= sheet.getRow(row).getCell(11).getStringCellValue();
//	      Phone= sheet.getRow(row).getCell(12).getNumericCellValue();
//		  Employment= sheet.getRow(row).getCell(13).getStringCellValue();
//		  Occupation= sheet.getRow(row).getCell(14).getStringCellValue();
//		  Adress= sheet.getRow(row).getCell(15).getStringCellValue();
//		  TypeofHouseHold= sheet.getRow(row).getCell(16).getStringCellValue();
//		  Licence= sheet.getRow(row).getCell(17).getStringCellValue();
//		  EssentialDriving= sheet.getRow(row).getCell(18).getStringCellValue();
//		  LicenceTime= sheet.getRow(row).getCell(19).getStringCellValue();
//		  PenaltyPoints= sheet.getRow(row).getCell(20).getStringCellValue();
//		  HowManyPenalty= sheet.getRow(row).getCell(21).getNumericCellValue();
//		  Reason= sheet.getRow(row).getCell(22).getStringCellValue();
//		  RecentInsurance= sheet.getRow(row).getCell(23).getStringCellValue();
//		  NCD= sheet.getRow(row).getCell(24).getStringCellValue();
//		  Discount= sheet.getRow(row).getCell(25).getStringCellValue();
//		  return this;
//     }
//    
//    public MasterTest PageOneLouncher() throws InterruptedException { 
//			page1.CookiesHandler().
//			EnterRegistrationNumber(Registration).
//			WillthisCarbeUsedforBusinessPurpouseorCommunity(BusinessPurpouse,CommunityPurpouse);
//
//		if (page1.CheckifTextIsDisyplayed("What type of business use cover do you require?")) {
//				page1.TypeOfBusinessCover(TypeOfBusiness);
//		   }
//		 page1.HowManyKilometersPerYear(KM).
//		       EnterYouPersonalData(Male,Name, Surname).
//		       EnterYouDataOfBirth(Day, Month,Year).
//		       EnterEmailandPhoneNumber(email,Phone).
//		       EmploymentStatus(Employment);
//		 
//		 if(page1.CheckifTextIsDisyplayed("What is your occupation?")) {
//			page1.EnterOccupation(Occupation);
//		 }
//		 if(page1.CheckifTextIsDisyplayed("Please enter your address or Eircode")) {
//			 page1.EnterAdress(Adress);
//		 }
//		 
//		 page1.TypeOfHouseHold(TypeofHouseHold).
//		       CurrentLicenceType(Licence);
//		       
//		 if(page1.CheckifTextIsDisyplayed("Have you completed the Essential Driver Training?")) {
//			 page1.EssentialDrivingTrainin(EssentialDriving);
//		 }
//		 page1.HowLongLicence(LicenceTime).
//		       PenaltyPointQuestion("No");
//		 if(page1.CheckifTextIsDisyplayed(("How many penalty points do you have?"))){
//			  page1.HowManyPenaltyPointandReason(HowManyPenalty, "No");
//		  }
//		  if(page1.CheckifTextIsDisyplayed(("What was your most recent insurance?"))) {
//			   page1.RecentInsuranceType(RecentInsurance);
//		  } 	
//		 if(page1.CheckifTextIsDisyplayed("Number of years No Claims Discount earned in Ireland and/or the UK")){
//			  page1.NumberOfNCD(NCD);
//		 }
//		 page1.
//		 PolicyDiscount("No").
//		 DownSiteConfirmationandConfirmation();
//		 return this;
//	  }	
//	
    public MasterTest PageTwoLouncher() {
	
    	 page2.CheckifPage2isLoaded().
    	       GetReferenceNumberAndQuote().
	           CalculateDetails().
	           ConfirmCalculationMoveToPage3();
    	 
	
    	 return this;
}

    public MasterTest PageThreeLouncher() throws InterruptedException {
    	
    	page3.CheckifPage3isLoaded().
    		  AddBreakDownAssistance(MasterData.Breakdown).
    	      AddOpenDriving(MasterData.OpenDriving).
    	      AddProtectedNoClaim(MasterData.ProtectedNoClaim).
    	      MoveToPageFour();
    	
    	return this;
    }

    public MasterTest PageFourLouncher() throws InterruptedException {
    	
    	page4.
    	CheckifPage4isloaded().
    	EnterInsuranceExpiryQuestion("No");
    	if (page1.CheckifTextIsDisyplayed("When does your existing policy expire?")) {
			page4.WhatDoesYourExistingPolicyExpire("20/11/2022");
			}
    	page4.isPolicyRefused("Yes").
    		  IsCarmodified("No")
    	      .EstimatedCarValue("No");
    	if(page1.CheckifTextIsDisyplayed("What is the value of the car?")) {
    		page4.EnterValueofCar("5,001 to 7,000");
    		}
    	page4.DidYouPurchaseTheCar("No");
    	if(page1.CheckifTextIsDisyplayed("When did you purchase the car?")) {
    		
    		}
    	
    	
    	return this;
    }
    
	
}
